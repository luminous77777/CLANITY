<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>문의내역</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Noto Sans 폰트  -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bxslider@4.2.17/dist/jquery.bxslider.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <!-- js -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bxslider@4.2.17/dist/jquery.bxslider.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    body {
      background-color: #f8f9fa;
    }

    /* 전체 레이아웃 구성 */
    .settings-wrapper {
      display: flex;
      gap: 2rem;
    }

    .category-menu {
      width: 180px;
      font-weight: bold;
    }

    .pill-btn {
      border-radius: 50rem;
      background-color: #e9ecef;
      padding: 0.5rem 1rem;
      font-weight: 500;
      border: none;
      cursor: pointer;
    }

    .pill-btn:hover {
      background-color: #ced4da;
    }

    .pill-btn:active {
    background-color: #E63946;
    font-weight: bold;
    }

    .card-header{
      background-color: #ffffff;
    }
    .answer-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 0.5rem;
    }
    .answer-header img {
      width: 32px;
      height: 32px;
      border-radius: 50%;
    }
    .answer-buttons button {
      margin-left: 8px;
    }

    .clickable-card-header {
      cursor: pointer;
    }

  </style>
</head>

<main>
  <body class="p-4">

<div class="settings-wrapper">
  <!-- 좌측 메뉴 -->
  <div class="category-menu">
    <button class="pill-btn w-100">문의 내역</button>
  </div>

  <!-- 우측 설정 -->
  <div class="flex-grow-1">
    <h4>문의내역</h4>
    <div class="mb-3 text-muted small">고객님의 문의하신 문의내역입니다</div>

  <!-- 설명 -->
    <div class="card mb-0">
        <div class="card-header d-flex justify-content-between"
            aria-expanded="false">
          <div>
            <span class="me-2 text-muted small">답변상태</span>
            <span class="me-2 text-muted small">| [질문대상]</span>
            <span class="inquiry-title text-muted small">질문제목</span>
          </div>
          <span class="text-muted small">작성일자</span>
        </div>
    </div>

  <div class="accordion" id="inquiryAccordion">
    <!-- 첫 번째 카드 (답변대기) -->
    <div class="card mb-2">
    <div class="card-header d-flex justify-content-between clickable-header"
        data-target="#inquiry1">
        <div>
            <span class="me-2 text-primary">답변대기</span>
            <span class="me-2">| [강사님]</span>
            <span class="inquiry-title text-dark">강사님 환불해주세요</span>
        </div>
            <span>2025.06.23</span>
          </div>

      <!-- 본문 -->
      <div id="inquiry1" class="collapse inquiry-content">
        <div class="card-body">
          <p class="mb-2">수업 시간 잘못봤어요 ㅠㅠ 그 시간에 서울에 없어요. 수강취소랑 환불 해주세요여</p>
          <hr>
          <div class="answer-section">
            <form class="answer-form">
              <div class="mb-3">
                <label class="form-label">답변 작성</label>
                <textarea class="form-control" rows="3" placeholder="답변을 입력하세요"></textarea>
              </div>
              <button type="submit" class="btn btn-sm text-white"
                      style="background-color: #E63946; border-color: #E63946;">답변 등록</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>


    <!-- 두 번째 카드 (답변대기) -->
    <div class="card mb-3">
    <div class="card-header d-flex justify-content-between clickable-header"  
        data-target="#inquiry2" style="cursor: pointer;">
        <div>
            <span class="me-2 text-primary">답변대기</span>
            <span class="me-2">| [강사님]</span>
            <span class="inquiry-title text-dark">강사님 환불해주세요</span>
        </div>
            <span>2025.06.23</span>
          </div>

      <!-- 본문 -->
      <div id="inquiry2" class="collapse inquiry-content">
        <div class="card-body">
          <p class="mb-2">문의내역2 컨텐츠</p>
          <hr>
          <div class="answer-section">
            <form class="answer-form">
              <div class="mb-3">
                <label class="form-label">답변 작성</label>
                <textarea class="form-control" rows="3" placeholder="답변을 입력하세요"></textarea>
              </div>
              <button type="submit" class="btn btn-sm text-white"
                      style="background-color: #E63946; border-color: #E63946;">답변 등록</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    </div>
  </div>
  </div>
</main>

  <!-- 푸터 -->
  <footer class="bg-light border-top mt-auto py-5">
    <div class="container">
      <div class="row text-muted small">
        
        <!-- 정보 -->
        <div class="col-md-4 mb-4">
          <h6 class="fw-semibold text-dark">클래니티 정보</h6>
          <ul class="list-unstyled mt-3">
            <li><a href="#" class="text-decoration-none text-dark">공지사항</a></li>
            <li><a href="#" class="text-decoration-none text-dark">이벤트</a></li>
            <li><a href="#" class="text-decoration-none text-dark">자주 묻는 질문</a></li>
            <li><a href="#" class="text-decoration-none text-dark">제휴 및 입점 문의</a></li>
            <li><a href="#" class="text-decoration-none text-dark">채용</a></li>
          </ul>
        </div>

        <!-- 소셜 -->
        <div class="col-md-4 mb-4">
          <h6 class="fw-semibold text-dark">소셜 미디어</h6>
          <ul class="list-unstyled mt-3">
            <li><a href="#" class="text-decoration-none text-dark">인스타그램</a></li>
            <li><a href="#" class="text-decoration-none text-dark">네이버 블로그</a></li>
          </ul>
        </div>

        <!-- 회사정보 -->
        <div class="col-md-4">
          <h6 class="fw-semibold text-dark">주식회사 클래니티</h6>
          <p class="mt-3 mb-1">대표: 다모아 | 개인정보관리책임자: 다모아</p>
          <p class="mb-1">사업자등록번호: 000-00-00000 | 통신판매: 제2025-서울구로-0622</p>
          <p class="mb-1">이메일: clanity@clanity.kr | 대표번호: 000-0000-0000</p>
          <p class="mb-1">주소: 서울 구로구 디지털로 306</p>
          <p class="mb-3">고객센터: @카카오톡채널 | 운영시간: (월~일) 오전 10:00 ~ 오후 5:00</p>
          <div class="d-flex gap-2">
            <a href="#" class="text-decoration-none text-dark">이용약관</a> |
            <a href="#" class="text-decoration-none text-dark">개인정보처리방침</a> |
            <a href="#" class="text-decoration-none text-dark">사업자정보확인</a>
          </div>
        </div>

      </div>
    </div>
  </footer>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    $(function () {

      $('.clickable-header').on('click', function () {
        const target = $(this).data('target');
        $(target).collapse('toggle');
      });
      // 답변 등록
      $('.answer-form').on('submit', function (e) {
        e.preventDefault();
        const $form = $(this);
        const $answerSection = $form.closest('.answer-section');
        const answer = $form.find('textarea').val().trim();

        if (!answer) {
          alert('답변을 입력해주세요.');
          return;
        }

        // 답변 영역에 프로필 + 닉네임 + 답변 텍스트 + 버튼들 추가
        const profileImgUrl = 'https://i.pravatar.cc/32?u=admin'; // 관리자 프로필 이미지 URL
        const nickname = '관리자'; // 관리자 닉네임

        const answerHtml = `
          <div class="answer-header">
            <img src="${profileImgUrl}" alt="관리자 프로필" />
            <strong>${nickname}</strong>
          </div>
          <p class="answer-text">${answer.replace(/\n/g, '<br>')}</p>
          <div class="answer-buttons">
            <button type="button" class="btn btn-outline-secondary btn-sm btn-edit">수정</button>
            <button type="button" class="btn btn-outline-danger btn-sm btn-delete">삭제</button>
          </div>
        `;

        $answerSection.html(answerHtml);

        // 상태 텍스트 변경
        const $cardHeader = $answerSection.closest('.card-body').siblings('.card-header');
        $cardHeader.find('span.text-primary').removeClass('text-primary').addClass('text-success').text('답변완료');
      });

      // 답변 수정
      $(document).on('click', '.btn-edit', function () {
        const $answerSection = $(this).closest('.answer-section');
        const currentAnswer = $answerSection.find('.answer-text').html().replace(/<br>/g, '\n');

        const profileHtml = $answerSection.find('.answer-header')[0].outerHTML;
        const nickname = $answerSection.find('.answer-header strong').text();

        const editFormHtml = `
          ${profileHtml}
          <form class="answer-edit-form">
            <div class="mb-3">
              <textarea class="form-control" rows="3">${currentAnswer}</textarea>
            </div>
            <button type="submit" class="btn btn-sm text-white" style="background-color: #E63946; border-color: #E63946;">수정 완료</button>
            <button type="button" class="btn btn-secondary btn-sm btn-cancel">취소</button>
          </form>
        `;

        $answerSection.html(editFormHtml);
      });

      // 수정 취소
      $(document).on('click', '.btn-cancel', function () {
        const $answerSection = $(this).closest('.answer-section');
        // 취소 시 답변 원래 상태로 복원 (간단하게 새로고침 권장, 아니면 별도 저장 로직 필요)
        location.reload();
      });

      // 수정 완료
      $(document).on('submit', '.answer-edit-form', function (e) {
        e.preventDefault();
        const $form = $(this);
        const $answerSection = $form.closest('.answer-section');
        const updatedAnswer = $form.find('textarea').val().trim();

        if (!updatedAnswer) {
          alert('답변을 입력해주세요.');
          return;
        }

        const profileHtml = $answerSection.find('.answer-header')[0].outerHTML;

        const answerHtml = `
          ${profileHtml}
          <p class="answer-text">${updatedAnswer.replace(/\n/g, '<br>')}</p>
          <div class="answer-buttons">
            <button type="button" class="btn btn-outline-secondary btn-sm btn-edit">수정</button>
            <button type="button" class="btn btn-outline-danger btn-sm btn-delete">삭제</button>
          </div>
        `;

        $answerSection.html(answerHtml);
      });

      // 답변 삭제
      $(document).on('click', '.btn-delete', function () {
        if (!confirm('답변을 삭제하시겠습니까?')) return;

        const $answerSection = $(this).closest('.answer-section');

        const originalFormHtml = `
          <p class="text-muted"><strong>답변없음</strong></p>
          <form class="answer-form">
            <div class="mb-3">
              <label class="form-label">답변 작성</label>
              <textarea class="form-control" rows="3" placeholder="답변을 입력하세요"></textarea>
            </div>
            <button type="submit" class="btn btn-primary btn-sm">답변 등록</button>
          </form>
        `;

        $answerSection.html(originalFormHtml);

        // 상태 텍스트 변경
        const $cardHeader = $answerSection.closest('.card-body').siblings('.card-header');
        $cardHeader.find('span.text-success').removeClass('text-success').addClass('text-primary').text('답변대기');
      });
    });
  </script>
</body>
</html>
